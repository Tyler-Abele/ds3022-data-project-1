2025-09-28 15:42:11,747 - INFO - Connected to DuckDB instance
2025-09-28 15:42:13,685 - ERROR - An error occurred: HTTP Error: HTTP GET error reading 's3://dp-1p3022/trip-data/yellow_tripdata_2024-/?encoding-type=url&list-type=2&prefix=trip-data%2Fyellow_tripdata_2024-' in region 'us-east-1' (HTTP 403 Forbidden)

Authentication Failure - this is usually caused by invalid or missing credentials.
* No credentials are provided.
* See https://duckdb.org/docs/stable/extensions/httpfs/s3api.html
2025-09-28 15:42:13,690 - INFO - Closed DuckDB connection
2025-09-28 15:47:08,199 - INFO - Connected to DuckDB instance
2025-09-28 15:47:09,452 - ERROR - An error occurred: HTTP Error: HTTP GET error reading 's3://dp-1p3022/trip-data/yellow_tripdata_2024-/?encoding-type=url&list-type=2&prefix=trip-data%2Fyellow_tripdata_2024-' in region 'us-east-1' (HTTP 403 Forbidden)

Authentication Failure - this is usually caused by invalid or missing credentials.
* No credentials are provided.
* See https://duckdb.org/docs/stable/extensions/httpfs/s3api.html
2025-09-28 15:47:09,455 - INFO - Closed DuckDB connection
2025-09-28 15:51:05,651 - INFO - DuckDB version: 1.3.2
2025-09-28 15:51:05,651 - INFO - AWS_ACCESS_KEY_ID present? False
2025-09-28 15:51:05,685 - INFO - Connected to DuckDB instance
2025-09-28 15:51:05,717 - ERROR - An error occurred: Catalog Error: Scalar Function with name getenv does not exist!
Did you mean "get_current_time"?

LINE 1: SET s3_access_key_id = getenv('AWS_ACCESS_KEY_ID')
                               ^
2025-09-28 16:02:25,543 - INFO - Connected to DuckDB instance
2025-09-28 16:02:27,281 - ERROR - An error occurred: HTTP Error: HTTP GET error reading 's3://dp-1p3022/trip-data/yellow_tripdata_2024-/?encoding-type=url&list-type=2&prefix=trip-data%2Fyellow_tripdata_2024-' in region 'us-east-1' (HTTP 403 Forbidden)

Authentication Failure - this is usually caused by invalid or missing credentials.
* No credentials are provided.
* See https://duckdb.org/docs/stable/extensions/httpfs/s3api.html
2025-09-28 16:11:09,995 - INFO - Connected to DuckDB instance
2025-09-28 16:11:10,903 - ERROR - An error occurred: HTTP Error: HTTP GET error reading 's3://dp-1p3022/trip-data/yellow_tripdata_2024-/?encoding-type=url&list-type=2&prefix=trip-data%2Fyellow_tripdata_2024-' in region 'us-east-1' (HTTP 403 Forbidden)

Authentication Failure - this is usually caused by invalid or missing credentials.
* No credentials are provided.
* See https://duckdb.org/docs/stable/extensions/httpfs/s3api.html
2025-09-28 16:16:31,235 - INFO - Connected to DuckDB
2025-09-28 16:16:55,861 - INFO - Created/loaded table yellow_2024
2025-09-28 16:16:56,390 - ERROR - Load failed
Traceback (most recent call last):
  File "/Users/tylerabele/Desktop/Data-Science/3rd-Year/DS_3022/ds3022-data-project-1/load.py", line 27, in main
    with duckdb.connect(DB_FILE, read_only=False) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tylerabele/Desktop/Data-Science/3rd-Year/DS_3022/ds3022-data-project-1/load.py", line 47, in main
    con.execute(
duckdb.duckdb.InvalidInputException: Invalid Input Error: File 'https://dp-1p3022.s3.amazonaws.com/trip-data/green_tripdata_2024-10.parquet' too small to be a Parquet file
2025-09-28 16:33:21,130 - INFO - Connected to DuckDB
2025-09-28 16:33:40,862 - INFO - Created/loaded table yellow_2024
2025-09-28 16:33:42,413 - INFO - Created/loaded table green_2024
2025-09-28 16:33:42,487 - ERROR - Load failed
Traceback (most recent call last):
  File "/Users/tylerabele/Desktop/Data-Science/3rd-Year/DS_3022/ds3022-data-project-1/load.py", line 27, in main
    with duckdb.connect(DB_FILE, read_only=False) as con:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tylerabele/Desktop/Data-Science/3rd-Year/DS_3022/ds3022-data-project-1/load.py", line 57, in main
    con.execute(
duckdb.duckdb.IOException: IO Error: No files found that match the pattern "vehicle_emissions.csv"
2025-09-28 16:35:56,613 - INFO - Connected to DuckDB
2025-09-28 16:36:35,590 - INFO - Created/loaded table yellow_2024
2025-09-28 16:36:37,390 - INFO - Created/loaded table green_2024
2025-09-28 16:36:37,397 - INFO - Created/loaded table vehicle_emissions
2025-09-28 16:36:37,404 - INFO - yellow_2024 row count: 41169720
2025-09-28 16:36:37,404 - INFO - green_2024 row count: 660218
2025-09-28 16:36:37,404 - INFO - vehicle_emissions row count: 8
2025-09-28 16:36:37,404 - INFO - Load complete
2025-09-29 18:59:25,566 - INFO - Connected to DuckDB
2025-09-29 19:06:51,130 - ERROR - Load failed
2025-09-29 19:35:47,974 - INFO - Connected to DuckDB
2025-09-29 19:53:15,199 - INFO - Created/loaded table yellow
2025-09-29 19:54:37,398 - INFO - Created/loaded table green
2025-09-29 19:54:37,424 - INFO - Created/loaded table vehicle_emissions
2025-09-29 19:54:37,487 - INFO - yellow row count: 752830638
2025-09-29 19:54:37,494 - INFO - green row count: 67647679
2025-09-29 19:54:37,494 - INFO - vehicle_emissions row count: 8
2025-09-29 19:54:37,494 - INFO - Load complete
